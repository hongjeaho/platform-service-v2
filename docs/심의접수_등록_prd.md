# 요구사항 정의서 - 재결신청 접수 화면

## 1. 화면 개요

### 1.1 화면 경로
- **URL**: `/receipt/application/{judgSeq}`
- **화면명**: LTIS 입력 정보 등록
- **접근 권한**: 사업시행자

### 1.2 화면 구성
화면은 현재 진행 상태(stateCode)와 라우터 상태(locationState)에 따라 3가지 화면으로 분기됩니다.

#### 1.2.1 화면 분기 조건
| 상태 코드 | 조건 | 표시 화면 | 설명 |
|----------|------|----------|------|
| CR001000 | isWrite ≠ true | ReceiptPreview | LTIS 입력 정보 확인 (미리보기) |
| CR001000 ~ CR001006 | isWrite = true | ReceiptWrite | LTIS 입력 정보 등록 (작성) |
| CR001007 | isComplete ≠ true | ReceiptView | LTIS 입력 정보 조회 (완료) |

#### 1.2.2 로딩 상태 처리
- 데이터 로딩 중: 스켈레톤 로딩 UI 표시
- 페이지 진입 시: 자동으로 페이지 상단으로 스크롤

---

## 2. LTIS 입력 정보 등록 화면 (ReceiptWrite)

### 2.1 상단 영역

#### 2.1.1 페이지 제목
- **표시 내용**: "LTIS 입력 정보 등록"
- **위치**: 화면 최상단

#### 2.1.2 사업 요약 정보 (BusinessInfo) - 상단 고정
- **표시 방식**: 화면 스크롤 시에도 항상 상단에 고정
- **구성 요소**:
    - 사건번호
    - 사건명
    - 접수일자
    - LTIS 진행상태
    - 사업시행자
    - 가격시점
    - 재결구분
    - 수용재결기관
    - 평가법인
    - 위치
    - 규모

### 2.2 스텝 UI 구성

#### 2.2.1 전체 스텝 구조
화면은 6단계의 스텝으로 구성되며, 각 스텝은 순차적으로 진행됩니다.

| 순서 | 스텝명 | 아이콘 | 폼 ID | 상태 코드 |
|------|--------|--------|-------|-----------|
| 1 | 사업 개요 | FileText | receiptCaseInfoForm | CR001001 |
| 2 | 총 물량조서 | Calculator | receiptTotalQuantityReport | CR001002 |
| 3 | 협의 감정평가 정보 | FileSearch | receiptPreviousAppraisalForm | CR001003 |
| 4 | 첨부 파일 | Paperclip | receiptAttachmentFileForm | CR001004 |
| 5 | 열람공고 결과 작성 | Edit3 | receiptNoticeResultForm | CR001005 |
| 6 | 의견 작성 | MessageSquare | receiptTemplateOpinionForm | CR001006 |

#### 2.2.2 스텝 네비게이션 동작
- **스텝 클릭**: 완료된 스텝만 클릭하여 이동 가능
- **이전 스텝 버튼**: 현재 스텝이 0보다 클 때만 활성화
- **다음 스텝 버튼**: 현재 스텝이 마지막 스텝이 아닐 때 활성화
- **자동 완료 처리**: 다음 스텝으로 이동 시 현재 스텝 자동 완료

---

## 3. 1단계: 사업 개요

### 3.1 사업 정보

#### 3.1.1 입력 필드
| 필드명 | 입력 형식 | 필수 여부 | 유효성 검증 | placeholder |
|--------|----------|----------|------------|-------------|
| 규모(단위) | 텍스트 | 필수 | required | 예) 1.234㎡ |
| 사업 기간 | 텍스트 | 필수 | required | - |
| 재결신청 사유 | 텍스트 | 필수 | required | - |

#### 3.1.2 레이아웃
```
┌────────────────────────────────────────────────────────────┐
│ 사업 정보                                                   │
├──────────────┬──────────────┬──────────────┬──────────────┤
│ 규모(단위)    │ [입력필드]    │ 사업 기간     │ [입력필드]    │
├──────────────┴──────────────┴──────────────┴──────────────┤
│ 재결신청 사유  │ [입력필드 - colspan=3]                     │
└────────────────────────────────────────────────────────────┘
```

### 3.2 협의 정보

#### 3.2.1 테이블 구조
| 협의 날짜 | 협의 내용 | 동작 |
|----------|----------|------|
| DatePicker | 텍스트 입력 | 추가/삭제 버튼 |

#### 3.2.2 동작 사양
- **초기 상태**: 최소 1개 행 존재 (삭제 불가)
- **첫 번째 행**: "추가" 버튼 표시 (파란색 배경)
- **추가된 행**: "삭제" 버튼 표시 (녹색 배경)
- **추가 기능**: "추가" 버튼 클릭 시 새로운 행 추가
- **삭제 기능**: "삭제" 버튼 클릭 시 해당 행 삭제

#### 3.2.3 유효성 검증
| 필드 | 검증 규칙 | 오류 메시지 |
|------|----------|------------|
| 협의 날짜 | required | 협의 날짜를 입력해 주세요 |
| 협의 내용 | required | 협의 날짜 내용을 입력해 주세요 |

### 3.3 도시계획 [사업인정] 관계

#### 3.3.1 테이블 구조
| 제목 | 내용 | 동작 |
|------|------|------|
| 텍스트 입력 | 텍스트 입력 | 추가/삭제 버튼 |

#### 3.3.2 동작 사양
- **초기 상태**: 최소 1개 행 존재 (삭제 불가)
- **첫 번째 행**: "추가" 버튼 표시 (파란색 배경)
- **추가된 행**: "삭제" 버튼 표시 (녹색 배경)
- **추가 기능**: "추가" 버튼 클릭 시 새로운 행 추가
- **삭제 기능**: "삭제" 버튼 클릭 시 해당 행 삭제

#### 3.3.3 유효성 검증
| 필드 | 검증 규칙 | 오류 메시지 |
|------|----------|------------|
| 제목 | required | 사업인정 관계 제목을 입력해 주세요 |
| 내용 | required | 사업인정 관계 내요을 입력해 주세요 |

### 3.4 하단 버튼
- **이전 스텝**: 비활성화 (첫 번째 스텝이므로)
- **다음 스텝**: 활성화, 클릭 시 2단계(총 물량조서)로 이동

---

## 4. 2단계: 총 물량조서

### 4.1 화면 로딩
- **로딩 상태**: 스켈레톤 UI 표시
- **데이터 조회**: `useGetReceiptQuantityReportByJudgSeq` API 호출
- **캐시 정책**: staleTime = 0 (항상 최신 데이터 조회)

### 4.2 수동 입력 모드

#### 4.2.1 수동 입력 버튼
- **위치**: 테이블 상단
- **초기 상태**: 수동 입력 모드 비활성화
- **동작**:
    - 클릭 시 수동 입력 모드 활성화
    - 총 보상대상 컬럼의 입력 필드 활성화
    - 자동 계산 기능 비활성화

### 4.3 테이블 구조

#### 4.3.1 헤더 구조
```
┌────────┬──────────────────────┬──────────────────────┬──────────────────────┐
│ 구분    │    총 보상대상        │     협의취득          │     재결신청          │
│        ├──────┬───────┬──────┼──────┬───────┬──────┼──────┬───────┬──────┤
│        │필,건  │면적(m²)│금액(천원)│필,건  │면적(m²)│금액(천원)│필,건  │면적(m²)│금액(천원)│
└────────┴──────┴───────┴──────┴──────┴───────┴──────┴──────┴───────┴──────┘
```

#### 4.3.2 데이터 행 구조
| 구분 | 총 보상대상 (필,건) | 총 보상대상 (면적) | 총 보상대상 (금액) | 협의취득 (필,건) | 협의취득 (면적) | 협의취득 (금액) | 재결신청 (필,건) | 재결신청 (면적) | 재결신청 (금액) |
|------|-------------------|------------------|------------------|----------------|---------------|---------------|----------------|---------------|---------------|
| 토지 | 자동계산/수동입력 | 자동계산/수동입력 | 자동계산/수동입력 | 입력 가능 | 입력 가능 | 입력 가능 | 입력 가능 | 입력 가능 | 입력 가능 |
| 물건 | 자동계산/수동입력 | - | 자동계산/수동입력 | 입력 가능 | - | 입력 가능 | 입력 가능 | - | 입력 가능 |
| 영업권 | 자동계산/수동입력 | - | 자동계산/수동입력 | 입력 가능 | - | 입력 가능 | 입력 가능 | - | 입력 가능 |
| 기타 | 자동계산/수동입력 | 자동계산/수동입력 | 자동계산/수동입력 | 입력 가능 | 입력 가능 | 입력 가능 | 입력 가능 | 입력 가능 | 입력 가능 |

### 4.4 입력 필드 사양

#### 4.4.1 입력 제한
| 필드 유형 | 입력 형식 | 최대 길이 | 소수점 | 비고 |
|----------|----------|---------|--------|------|
| 필,건 | 숫자만 | 8자리 | 불가 | 정수만 입력 |
| 면적(m²) | 숫자만 | 8자리 | 가능 | 소수점 입력 가능 |
| 금액(천 원) | 숫자만 | 8자리 | 불가 | 정수만 입력 |

#### 4.4.2 비활성화 필드
- **물건 - 면적**: 모든 컬럼에서 "-" 표시, 입력 불가
- **영업권 - 면적**: 모든 컬럼에서 "-" 표시, 입력 불가

### 4.5 자동 계산 로직

#### 4.5.1 총 보상대상 자동 계산 (수동 입력 모드가 아닐 때)
```
총 보상대상 = 협의취득 + 재결신청
```

**예시**:
- 협의취득 면적: 1.2
- 재결신청 면적: 2.2
- 총 보상대상 면적: 3.4 (자동 계산)

#### 4.5.2 합계 행 계산
테이블 하단 합계 행에는 각 컬럼의 합계가 자동으로 표시됩니다.

| 항목 | 계산 대상 |
|------|----------|
| 합계 - 필,건 | 토지 + 물건 + 영업권 + 기타 (필,건) |
| 합계 - 면적 | 토지 + 기타 (면적) |
| 합계 - 금액 | 토지 + 물건 + 영업권 + 기타 (금액) |

#### 4.5.3 표시 형식
- 모든 숫자는 천 단위 콤마 구분 표시 (예: 1,234,567)
- 면적은 소수점 표시 (예: 1,234.56)

### 4.6 하단 버튼
- **이전 스텝**: 활성화, 클릭 시 1단계(사업 개요)로 이동
- **다음 스텝**: 활성화, 클릭 시 3단계(협의 감정평가 정보)로 이동

---

## 5. 3단계: 협의 감정평가 정보

### 5.1 화면 로딩
- **로딩 상태**: 스켈레톤 UI 표시
- **데이터 조회**: `useGetReceiptPreviousAppraisalByJudgSeq` API 호출
- **캐시 정책**: staleTime = 0 (항상 최신 데이터 조회)

### 5.2 시도지사 추천

#### 5.2.1 시도지사 추천 여부
| 항목 | 입력 형식 | 필수 여부 | 유효성 검증 |
|------|----------|----------|------------|
| 시도지사 추천 여부 | 라디오 버튼 (네/아니오) | 필수 | 미선택 시 "시도지사 추천여부 선택은 필수 입니다." |

- **초기 상태**: 미선택 (null)
- **선택 옵션**:
    - 네 (true)
    - 아니오 (false)

#### 5.2.2 시도지사 추천 선택에 따른 화면 분기

##### 5.2.2.1 "아니오" 선택 시
**추가 입력 필드 표시**:
| 필드명 | 입력 형식 | 필수 여부 | 유효성 검증 |
|--------|----------|----------|------------|
| 시·도지사 추천 요청을 하지 않은 이유 | 텍스트 | 필수 | "시도지사 추천 하지 않는 이유 작성은 필수 입니다.." |

**필수 첨부파일**:
- 협의 공고 파일 (CR004001) - 필수

##### 5.2.2.2 "네" 선택 시
**필수 첨부파일**:
1. 협의 공고 파일 (CR004001) - 필수
2. 협의 의뢰 공문 (CR004002) - 필수
3. 협의 회신 공문 (CR004003) - 필수

### 5.3 협의 공고 첨부파일 섹션

#### 5.3.1 표시 조건
- 시도지사 추천 여부가 "네" 또는 "아니오"로 선택된 경우에만 표시

#### 5.3.2 파일 업로드 구조
| 문서명 | 코드 | 필수 여부 | 표시 조건 |
|--------|------|----------|----------|
| 협의 공고 파일 | CR004001 | 필수 | 항상 표시 |
| 협의 의뢰 공문 | CR004002 | 필수 | 시도지사 추천 = 네 |
| 협의 회신 공문 | CR004003 | 필수 | 시도지사 추천 = 네 |

### 5.4 협의 감정평가 정보

#### 5.4.1 테이블 헤더
| 추천 기관 | 감정평가 법인 | 협의 금액 | 감정평가서 | 동작 |
|----------|-------------|----------|-----------|------|
| 70px | 90px | 90px | 90px | 20px |

#### 5.4.2 기본 행 (항상 표시)

##### 5.4.2.1 사업시행자 (필수)
- **추천 코드**: CR003001
- **추천 기관명**: 사업시행자
- **입력 필드**:
  | 필드 | 입력 형식 | 필수 여부 | 유효성 검증 |
  |------|----------|----------|------------|
  | 감정평가 법인 | 텍스트 | 필수 | "추천 법인은 필수 입니다." |
  | 협의 금액 | 숫자 | 필수 | required, min: 1000 ("법인 금액은 1000보다 크게 입력하세요.") |
  | 감정평가서 | 파일 업로드 (PDF) | 필수 | "감정평가서를 업로드 하세요." |

##### 5.4.2.2 시도지사 추천 (조건부 표시)
- **추천 코드**: CR003002
- **추천 기관명**: 시도지사 추천
- **표시 조건**: 시도지사 추천 여부 = "네"
- **입력 필드**: 사업시행자와 동일
- **삭제 버튼**: 없음 (조건부 필수 항목)

#### 5.4.3 선택적 추가 행

##### 5.4.3.1 토지 소유자 (선택)
- **추천 코드**: CR003003
- **추천 기관명**: 토지 소유자
- **표시 조건**: "토지 소유자 추가" 버튼 클릭
- **입력 필드**: 사업시행자와 동일
- **삭제 버튼**: 있음 (회색 배경)

##### 5.4.3.2 사업시행자 추가 (선택)
- **추천 코드**: CR003004
- **추천 기관명**: 사업시행자
- **표시 조건**: "사업 시행자 추가" 버튼 클릭
- **입력 필드**: 사업시행자와 동일
- **삭제 버튼**: 있음 (회색 배경)

#### 5.4.4 추가 버튼 동작 사양

##### 5.4.4.1 버튼 표시 조건
- 토지 소유자와 사업시행자 추가가 모두 선택되지 않은 경우에만 표시
- 테이블 하단 중앙에 배치

##### 5.4.4.2 버튼 구성
| 버튼명 | 배경색 | 동작 | 제약 사항 |
|--------|-------|------|----------|
| 토지 소유자 추가 | 녹색 | 토지 소유자 행 추가 | 사업시행자 추가가 이미 선택된 경우 "이미 사업시행자가 추가 되어 있습니다." 알림 |
| 사업 시행자 추가 | 파란색 | 사업시행자 추가 행 추가 | 토지 소유자가 이미 선택된 경우 "이미 토지 소유자가 추가 되어 있습니다." 알림 |

##### 5.4.4.3 삭제 버튼 동작
- 해당 행 삭제
- 삭제 후 추가 버튼 영역 다시 표시

### 5.5 시도지사 추천 변경 시 동작
- 시도지사 추천을 "네"에서 "아니오"로 변경 시:
    - 시도지사 추천 행의 입력 데이터 초기화

### 5.6 하단 버튼
- **이전 스텝**: 활성화, 클릭 시 2단계(총 물량조서)로 이동
- **다음 스텝**: 활성화, 클릭 시 4단계(첨부 파일)로 이동

---

## 6. 4단계: 첨부 파일

### 6.1 화면 로딩
- **로딩 상태**: 스켈레톤 UI 표시
- **데이터 조회**: `useGetReceiptAttachmentByJudgSeq` API 호출
- **캐시 정책**: staleTime = 0 (항상 최신 데이터 조회)

### 6.2 안내 문구
- **위치**: 화면 상단 우측
- **내용**: "재결신청에 필요한 서류를 등록합니다."
- **스타일**: text-sm text-gray-600

### 6.3 유효성 검증 오류 표시
- **표시 조건**: 필수 서류가 누락된 경우
- **스타일**: 빨간색 배경 (bg-red-50), 빨간색 테두리
- **아이콘**: AlertCircle (빨간색)
- **메시지**:
    - 제목: "필수 서류가 누락되었습니다."
    - 내용: "빨간색으로 표시된 카테고리의 필수 서류를 업로드해주세요."

### 6.4 첨부파일 카테고리 구조

#### 6.4.1 전체 카테고리 목록 (14개)
| 순서 | 카테고리명 | 필수 여부 | 비고 |
|------|----------|----------|------|
| 1 | 적정성 검토서 | 필수 | - |
| 2 | 신청 문서(공문) | 필수 | - |
| 3 | 재결 신청서 | 필수 | - |
| 4 | 재결신청 청구서 | 선택 | - |
| 5 | 사업계획서 | 필수 | - |
| 6 | 사업인정 관련 고시 | 필수 | - |
| 7 | 최초(도시계획결정 및 변경) 고시 사본 (구보등) | 필수 | - |
| 8 | 중토위 의견청취 관련 문서 | 필수 | - |
| 9 | 소유자별서류 | 필수 | - |
| 10 | 사업 예정지 및 사업계획 도면 | 선택 | - |
| 11 | 협의관계서류 | 필수 | - |
| 12 | 기본 조사서 | 선택 | - |
| 13 | 기타 증빙서류 | 선택 | ※ 기타 증빙서류가 있는 경우 추가 버튼 눌러 업로드 해주세요 |

### 6.5 상세 문서 목록 (27개)

#### 6.5.1 적정성 검토서
| 문서명 | 코드 | 필수 | 복수 업로드 |
|--------|------|------|-----------|
| 적정성 검토서 | CR002001 | 필수 | 단일 |

#### 6.5.2 신청 문서(공문)
| 문서명 | 코드 | 필수 | 복수 업로드 |
|--------|------|------|-----------|
| 신청 문서(공문) | CR002002 | 필수 | 단일 |

#### 6.5.3 재결 신청서
| 문서명 | 코드 | 필수 | 복수 업로드 |
|--------|------|------|-----------|
| 재결 신청서 | CR002003 | 필수 | 단일 |

#### 6.5.4 재결신청 청구서
| 문서명 | 코드 | 필수 | 복수 업로드 |
|--------|------|------|-----------|
| 재결신청 청구서 | CR002004 | 선택 | 단일 |

#### 6.5.5 사업계획서
| 문서명 | 코드 | 필수 | 복수 업로드 |
|--------|------|------|-----------|
| 사업계획서 | CR002005 | 필수 | 단일 |

#### 6.5.6 사업인정 관련 고시
| 문서명 | 코드 | 필수 | 복수 업로드 | 비고 |
|--------|------|------|-----------|------|
| 구역결정 고시문 | CR002006 | 필수 | 단일 | - |
| 사업시행실시계획인가(시행인가) | CR002007 | 필수 | 복수 | ※ 변경고시(인가) 등 제출 서류가 있는 경우 추가 버튼 눌러 업로드 해주세요 |

#### 6.5.7 최초(도시계획결정 및 변경) 고시 사본 (구보등)
| 문서명 | 코드 | 필수 | 복수 업로드 |
|--------|------|------|-----------|
| 최초(도시계획결정 및 변경) 고시 사본 (구보등) | CR002008 | 필수 | 단일 |

#### 6.5.8 중토위 의견청취 관련 문서
| 문서명 | 코드 | 필수 | 복수 업로드 |
|--------|------|------|-----------|
| 결과 회신 공문 사본 | CR002009 | 필수 | 단일 |
| 이행(보완)여부 자료 | CR002010 | 선택 | 단일 |
| 이행(보완)여부 확인 증빙 서류 | CR002011 | 선택 | 단일 |

#### 6.5.9 소유자별서류
| 문서명 | 코드 | 필수 | 복수 업로드 |
|--------|------|------|-----------|
| 사업시행자 제시액 조서 | CR002012 | 필수 | 단일 |
| 토지조서(조서별 세목고시 첨부) | CR002013 | 선택 | 단일 |
| 물건조서 | CR002014 | 선택 | 단일 |
| 협의 경위서 | CR002015 | 필수 | 단일 |
| 토지 대장 | CR002016 | 선택 | 단일 |
| 등기사항전부증명서 | CR002017 | 선택 | 단일 |
| 토지이용계획확인서 | CR002018 | 선택 | 단일 |
| 지적도 | CR002019 | 선택 | 단일 |
| 측량도면 | CR002020 | 선택 | 단일 |

#### 6.5.10 사업 예정지 및 사업계획 도면
| 문서명 | 코드 | 필수 | 복수 업로드 |
|--------|------|------|-----------|
| 사업 예정지 및 사업계획 도면 | CR002021 | 선택 | 단일 |

#### 6.5.11 협의관계서류
| 문서명 | 코드 | 필수 | 복수 업로드 |
|--------|------|------|-----------|
| 보상계획공고 | CR002022 | 필수 | 단일 |
| 손실보상 협의 요청문서 | CR002023 | 필수 | 단일 |
| 공시 송달문서 | CR002024 | 선택 | 단일 |

#### 6.5.12 기본 조사서
| 문서명 | 코드 | 필수 | 복수 업로드 | 비고 |
|--------|------|------|-----------|------|
| 토지 기본 조사서 | CR002025 | 선택 | 단일 | - |
| 물건 기본 조사서 | CR002026 | 선택 | 단일 | ※ 2024.4.9 이후 보상계획 공고 또는 통지된 사업은 필수 업로드 해주세요 |

#### 6.5.13 기타 증빙서류
| 문서명 | 코드 | 필수 | 복수 업로드 |
|--------|------|------|-----------|
| 기타 증빙서류 | CR002027 | 선택 | 복수 |

### 6.6 파일 업로드 동작

#### 6.6.1 단일 파일 업로드
- 1개의 파일만 업로드 가능
- 기존 파일이 있는 경우 새 파일로 대체

#### 6.6.2 복수 파일 업로드
- "추가" 버튼을 통해 여러 파일 업로드 가능
- 각 파일별 삭제 버튼 제공

#### 6.6.3 파일 형식 제한
- 일반적으로 모든 형식 허용
- 감정평가서는 PDF 형식 권장

### 6.7 하단 버튼
- **이전 스텝**: 활성화, 클릭 시 3단계(협의 감정평가 정보)로 이동
- **다음 스텝**: 활성화, 클릭 시 5단계(열람공고 결과 작성)로 이동

---

## 7. 5단계: 열람공고 결과 작성

### 7.1 화면 로딩
- **로딩 상태**: 스켈레톤 UI 표시
- **데이터 조회**: `useGetNoticeResult` API 호출
- **캐시 정책**: staleTime = 0 (항상 최신 데이터 조회)

### 7.2 열람 공고 결과 등록

#### 7.2.1 입력 필드
| 필드명 | 입력 형식 | 필수 여부 | 유효성 검증 |
|--------|----------|----------|------------|
| 열람기간 | 날짜 범위 선택 (시작일 ~ 종료일) | 필수 | 시작일과 종료일 모두 필수 |
| 회보일 | 날짜 선택 | 필수 | "회보일을 입력해 주세요" |

#### 7.2.2 테이블 레이아웃
```
┌────────────┬───────────────────────┬────────────┬───────────────────────┐
│ 열람기간    │ [시작일 ~ 종료일]       │ 회보일      │ [날짜 선택]            │
└────────────┴───────────────────────┴────────────┴───────────────────────┘
```

### 7.3 열람공고 결과 첨부파일

#### 7.3.1 첨부파일 카테고리
- **카테고리명**: 열람공고 결과 첨부파일
- **필수 여부**: 필수

#### 7.3.2 문서 목록
| 문서명 | 코드 | 필수 | 복수 업로드 |
|--------|------|------|-----------|
| 회보공문 | CN001001 | 필수 | 복수 |
| 공고문 | CN001002 | 필수 | 복수 |
| 등기송달증빙 | CN001003 | 필수 | 복수 |
| 소유자 의견 | CN001004 | 필수 | 복수 |

#### 7.3.3 파일 업로드 동작
- 각 문서당 여러 개의 파일 업로드 가능
- "추가" 버튼을 통해 파일 추가
- 각 파일별 삭제 버튼 제공

### 7.4 하단 버튼
- **이전 스텝**: 활성화, 클릭 시 4단계(첨부 파일)로 이동
- **다음 스텝**: 활성화, 클릭 시 6단계(의견 작성)로 이동

---

## 8. 6단계: 의견 작성

### 8.1 화면 로딩
- **로딩 상태**: 스켈레톤 UI 표시
- **데이터 조회**: `useOpinionCaseTemplateCommitList` 훅 사용

### 8.2 쟁점의견 상세 설명 아코디언
- **컴포넌트**: OpinionTemplateDescriptionSection
- **표시 방식**: 아코디언 형식
- **내용**: 쟁점의견 작성 가이드 및 설명

### 8.3 의견 템플릿 코드 선택
- **컴포넌트**: OpinionTemplateCodeSelectBox
- **기능**: 미리 정의된 의견 템플릿 선택
- **동작**: 템플릿 선택 시 하단 코멘트 영역에 반영

### 8.4 의견 코멘트 작성
- **컴포넌트**: OpinionCaseTemplateCommentTabSection
- **표시 방식**: 탭 형식
- **입력 내용**: 선택한 템플릿에 대한 의견 및 코멘트 작성

### 8.5 데이터 갱신
- **Refetch 기능**: `onCommitListRefetch` 함수를 통해 데이터 재조회
- **호출 시점**:
    - 템플릿 코드 선택 후
    - 코멘트 작성/수정/삭제 후

### 8.6 하단 버튼
- **이전 스텝**: 활성화, 클릭 시 5단계(열람공고 결과 작성)로 이동
- **다음 스텝**: 비활성화 (마지막 스텝)

---

## 9. 하단 공통 버튼

### 9.1 버튼 구성
| 버튼명 | 표시 조건 | 동작 |
|--------|----------|------|
| 목록 보기 | 항상 표시 | `/receipt/application` 경로로 이동 |
| 이전 스텝 | 현재 스텝 > 0 | 이전 스텝으로 이동 |
| 다음 스텝 | 현재 스텝 < 마지막 스텝 | 다음 스텝으로 이동, 현재 스텝 완료 처리 |

### 9.2 폼 제출 동작
- **제출 방식**: HTML form 태그의 submit 이벤트
- **폼 ID**: 각 스텝별 고유 formId 사용
- **버튼 연결**: 다음 스텝 버튼이 해당 폼의 submit 버튼 역할
- **유효성 검증**: React Hook Form을 통한 자동 유효성 검증
- **제출 성공 시**:
    - 서버에 데이터 저장
    - 다음 스텝으로 자동 이동
    - 현재 스텝 완료 상태로 변경

---

## 10. 데이터 흐름 및 API

### 10.1 주요 API 엔드포인트

#### 10.1.1 조회 API
| API 함수명 | 용도 | 스텝 |
|-----------|------|------|
| useGetReceiptCurrentStatusCode | 현재 진행 상태 조회 | 전체 |
| useGetReceiptCaseInfoByJudgSeq | 사업 개요 조회 | 1단계 |
| useGetReceiptQuantityReportByJudgSeq | 총 물량조서 조회 | 2단계 |
| useGetReceiptPreviousAppraisalByJudgSeq | 협의 감정평가 정보 조회 | 3단계 |
| useGetReceiptAttachmentByJudgSeq | 첨부파일 조회 | 4단계 |
| useGetNoticeResult | 열람공고 결과 조회 | 5단계 |
| useOpinionCaseTemplateCommitList | 의견 코멘트 목록 조회 | 6단계 |

#### 10.1.2 저장 API (Submit 훅)
| 훅 함수명 | 용도 | 스텝 |
|----------|------|------|
| useReceiptCaseInfoSubmit | 사업 개요 저장 | 1단계 |
| useReceiptTotalQuantityReportSubmit | 총 물량조서 저장 | 2단계 |
| useReceiptPreviousAppraisalSubmit | 협의 감정평가 정보 저장 | 3단계 |
| useReceiptAttachmentUploadSubmit | 첨부파일 저장 | 4단계 |
| useReceiptNoticeResultSubmit | 열람공고 결과 저장 | 5단계 |
| useReceiptTemplateOpinionSubmit | 의견 저장 | 6단계 |

### 10.2 상태 관리
- **Form 상태**: React Hook Form을 통한 폼 상태 관리
- **API 상태**: React Query를 통한 서버 상태 관리
- **캐시 정책**: staleTime = 0 (항상 최신 데이터 조회)

### 10.3 파라미터
- **judgSeq**: URL 파라미터로 전달되는 재결 일련번호
- **추출 방법**: `useGetJudgSeq` 커스텀 훅 사용

---

## 11. UI/UX 사양

### 11.1 로딩 상태
- **초기 로딩**: 스켈레톤 로딩 UI 표시
- **데이터 재조회**: 스켈레톤 로딩 UI 표시 또는 기존 데이터 유지

### 11.2 오류 처리
- **유효성 검증 오류**:
    - 각 입력 필드 하단에 빨간색 오류 메시지 표시
    - 필수 서류 누락 시 상단에 경고 배너 표시
- **API 오류**: 적절한 오류 메시지 표시

### 11.3 스타일링
- **프레임워크**: Tailwind CSS
- **컬러 스킴**:
    - 주요 버튼 (다음 스텝): 파란색 (bg-blue-600)
    - 추가 버튼: 파란색 또는 녹색 (bg-green-600)
    - 삭제 버튼: 녹색 또는 회색 (bg-gray-600)
    - 오류: 빨간색 (bg-red-50, text-red-600)

### 11.4 반응형
- **최대 너비**: max-w-5xl (첨부파일 업로드 영역)
- **중앙 정렬**: mx-auto
- **여백**: 적절한 padding 및 margin 적용

### 11.5 접근성
- **폼 레이블**: 모든 입력 필드에 적절한 레이블 제공
- **필수 표시**: 필수 입력 필드 명시
- **오류 메시지**: 명확하고 구체적인 오류 메시지 제공

---

## 12. 비즈니스 규칙

### 12.1 스텝 진행 규칙
- **순차 진행**: 각 스텝은 순차적으로 완료해야 함
- **되돌아가기**: 완료된 스텝은 언제든 다시 수정 가능
- **스텝 완료**: 다음 스텝으로 이동 시 현재 스텝 자동 완료
- **최종 완료**: 6단계까지 모두 완료 시 상태 코드 CR001007로 변경

### 12.2 협의 감정평가 규칙
- **시도지사 추천**: 네/아니오 중 하나 필수 선택
- **추가 추천**: 토지 소유자와 사업시행자 추가는 동시에 선택 불가
- **파일 업로드**: 시도지사 추천 여부에 따라 필수 파일 달라짐

### 12.3 총 물량조서 규칙
- **수동/자동 모드**:
    - 자동 모드: 총 보상대상 = 협의취득 + 재결신청 (자동 계산)
    - 수동 모드: 총 보상대상 직접 입력 가능
- **면적 입력 제한**: 물건과 영업권은 면적 입력 불가 ("-" 표시)

### 12.4 첨부파일 규칙
- **필수 서류**: 카테고리 또는 문서별 필수 여부 확인
- **복수 업로드**: 문서별 단일/복수 업로드 제한 확인
- **파일 형식**: 감정평가서는 PDF 권장

### 12.5 동적 필드 규칙
- **협의 정보**: 최소 1개 이상 유지
- **사업인정 관계**: 최소 1개 이상 유지
- **첫 번째 행**: 삭제 불가, 추가 버튼만 표시

---

## 13. 권한 및 보안

### 13.1 접근 권한
- **사용자 유형**: 사업시행자만 접근 가능
- **재결 건별 권한**: 해당 재결 건의 담당자만 수정 가능

### 13.2 데이터 보안
- **파일 업로드**: 서버 측 파일 검증
- **입력 값 검증**: 클라이언트 및 서버 양측 검증
- **SQL Injection 방지**: 파라미터화된 쿼리 사용

---

## 14. 추가 기능 요구사항

### 14.1 자동 저장
- **현재 구현**: 각 스텝 완료 시 수동 저장
- **향후 개선**: 일정 시간마다 자동 임시 저장 기능 고려

### 14.2 진행 상황 표시
- **스텝 인디케이터**: 현재 스텝 및 완료 스텝 시각적 표시
- **진행률**: 전체 6단계 중 현재 진행 단계 표시

### 14.3 데이터 유효성 재검증
- **스텝 이동 시**: 현재 스텝의 데이터 유효성 재검증
- **최종 제출 전**: 전체 스텝의 데이터 유효성 검증

---

## 15. 테스트 시나리오

### 15.1 기본 플로우 테스트
1. `/receipt/application/{judgSeq}` 접속
2. 1단계부터 6단계까지 순차적으로 데이터 입력 및 저장
3. 각 스텝의 "다음 스텝" 버튼 클릭하여 진행
4. 6단계 완료 후 최종 상태 확인

### 15.2 유효성 검증 테스트
1. 필수 필드 누락 후 다음 스텝 시도
2. 잘못된 형식의 데이터 입력 (예: 숫자 필드에 문자 입력)
3. 파일 업로드 없이 다음 스텝 시도
4. 오류 메시지 표시 확인

### 15.3 동적 필드 테스트
1. 협의 정보 행 추가/삭제 테스트
2. 사업인정 관계 행 추가/삭제 테스트
3. 첫 번째 행 삭제 시도 (삭제 불가 확인)
4. 토지 소유자 추가 후 사업시행자 추가 시도 (제약 확인)

### 15.4 시도지사 추천 테스트
1. "네" 선택 후 필수 파일 확인
2. "아니오" 선택 후 이유 입력 및 파일 확인
3. "네"에서 "아니오"로 변경 시 데이터 초기화 확인

### 15.5 총 물량조서 테스트
1. 협의취득과 재결신청 입력 후 총 보상대상 자동 계산 확인
2. 수동 입력 모드 전환 후 직접 입력 확인
3. 합계 행 자동 계산 확인

### 15.6 파일 업로드 테스트
1. 단일 파일 업로드
2. 복수 파일 업로드
3. 파일 삭제
4. 필수 파일 누락 시 오류 표시 확인

---

## 16. 성능 요구사항

### 16.1 로딩 시간
- **초기 로딩**: 3초 이내
- **스텝 전환**: 1초 이내
- **파일 업로드**: 파일 크기에 따라 적절한 업로드 시간

### 16.2 최적화
- **지연 로딩**: 각 스텝 컴포넌트는 lazy loading 적용
- **이미지 최적화**: 업로드된 이미지 자동 최적화
- **캐싱**: React Query를 통한 적절한 캐싱 전략

### 16.3 파일 크기 제한
- **단일 파일**: 최대 10MB
- **전체 업로드**: 최대 100MB (향후 조정 가능)

---

## 17. 브라우저 호환성

### 17.1 지원 브라우저
- Chrome (최신 버전)
- Firefox (최신 버전)
- Safari (최신 버전)
- Edge (최신 버전)

### 17.2 모바일 지원
- iOS Safari (최신 버전)
- Android Chrome (최신 버전)

---

## 18. 향후 개선 사항

### 18.1 기능 개선
- [ ] 자동 임시 저장 기능
- [ ] 진행률 표시 개선
- [ ] 파일 미리보기 기능
- [ ] 드래그 앤 드롭 파일 업로드
- [ ] 일괄 파일 업로드

### 18.2 UX 개선
- [ ] 스텝 간 이동 애니메이션
- [ ] 툴팁을 통한 입력 가이드 제공
- [ ] 입력 예시 표시
- [ ] 모바일 UI 최적화

### 18.3 관리 기능
- [ ] 입력 히스토리 추적
- [ ] 수정 이력 관리
- [ ] 다운로드 기능 (PDF, Excel)
- [ ] 인쇄 기능

---